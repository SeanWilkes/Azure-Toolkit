# ============================================# Start_Stop-VM.ps1# Author: Sean Wilkes  |  GitHub: SeanWilkes# Description: Provides PowerShell commands for managing #              the Azure lab VM lifecycle (start, stop, and verify).# ============================================param(    [string]$ResourceGroup = "LAB-RG",    [string]$VmName = "wfhlabvm01",    [switch]$Preview)# Check current VM stateWrite-Host "Retrieving VM status..."$vmStatus = (Get-AzVM -ResourceGroupName $ResourceGroup -Name $VmName -Status).Statuses |              Where-Object { $_.Code -match "PowerState" }Write-Host "Current status of $VmName: $($vmStatus.DisplayStatus)"# Stop VMif ($Preview) {    Write-Host "[Preview] Would stop VM '$VmName' in resource group '$ResourceGroup'."} else {    Stop-AzVM -ResourceGroupName $ResourceGroup -Name $VmName -Force    Write-Host "VM '$VmName' stopped successfully."}# Start VMif ($Preview) {    Write-Host "[Preview] Would start VM '$VmName'."} else {    Start-AzVM -ResourceGroupName $ResourceGroup -Name $VmName    Write-Host "VM '$VmName' started successfully."}# Verify againWrite-Host "Final VM state:"(Get-AzVM -ResourceGroupName $ResourceGroup -Name $VmName -Status).Statuses |     Where-Object { $_.Code -match "PowerState" } |     Select DisplayStatus